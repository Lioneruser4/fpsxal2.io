<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SA≈ûKƒ∞ OYUNU - Profesyonel FPS</title>
    <!-- Three.js ve Socket.IO -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; font-family: 'Segoe UI', system-ui, sans-serif; }
        body { background: #0a0c10; color: white; overflow: hidden; width: 100vw; height: 100vh; }
        
        /* BEKLEME EKRANI (LOADING) */
        #loadingScreen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #1a1e2a, #0b0d15);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 1000; transition: opacity 0.5s;
        }
        .spinner { width: 60px; height: 60px; border: 6px solid rgba(255,70,120,0.2); border-top-color: #ff4678; border-radius: 50%; animation: spin 0.8s linear infinite; margin-bottom: 25px; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { font-size: 22px; font-weight: 600; background: linear-gradient(45deg, #ff4678, #ff9f4a); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 2px; margin-bottom: 8px; }
        .loading-sub { color: #8899bb; font-size: 14px; }
        
        /* ANA MEN√ú */
        #mainMenu {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 20% 30%, #1e2a3a, #0e121c);
            display: flex; flex-direction: column; padding: 30px 20px; overflow-y: auto;
        }
        .menu-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 40px; }
        .menu-header h1 { font-size: 32px; font-weight: 800; background: linear-gradient(45deg, #ff4678, #ffbc3b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .user-badge { background: rgba(255,255,255,0.08); padding: 8px 16px; border-radius: 40px; display: flex; align-items: center; gap: 10px; border: 1px solid rgba(255,70,120,0.3); }
        .user-badge img { width: 32px; height: 32px; border-radius: 50%; border: 2px solid #ff4678; }
        
        .menu-buttons { display: flex; flex-direction: column; gap: 16px; margin-bottom: 40px; }
        .menu-btn { background: rgba(20,30,45,0.8); backdrop-filter: blur(8px); border: 1px solid rgba(255,255,255,0.1); padding: 18px; border-radius: 20px; color: white; font-size: 20px; font-weight: 600; display: flex; align-items: center; gap: 15px; cursor: pointer; transition: 0.2s; box-shadow: 0 8px 20px rgba(0,0,0,0.4); }
        .menu-btn.primary { background: linear-gradient(145deg, #ff4678, #d42b5c); border: none; }
        .menu-btn:active { transform: scale(0.98); }
        .menu-btn .icon { font-size: 28px; }
        
        /* LOBI (ODA Lƒ∞STESƒ∞) */
        .section-title { font-size: 22px; margin-bottom: 20px; color: #ffbc3b; display: flex; align-items: center; gap: 10px; }
        .rooms-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px; }
        .room-card { background: rgba(20,30,45,0.6); backdrop-filter: blur(4px); border-radius: 20px; padding: 16px; border-left: 5px solid #ff4678; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .room-card .room-name { font-weight: 700; font-size: 18px; margin-bottom: 5px; }
        .room-card .room-players { display: flex; gap: 20px; margin: 12px 0; }
        .team-badge.red { color: #ff6b6b; } .team-badge.blue { color: #6ba6ff; }
        .join-btn { background: rgba(255,70,120,0.2); border: 1px solid #ff4678; padding: 8px; border-radius: 40px; width: 100%; color: white; font-weight: 600; cursor: pointer; }
        
        /* ODA OLU≈ûTURMA */
        .create-room-panel { background: rgba(0,0,0,0.3); border-radius: 30px; padding: 25px; margin-top: 20px; }
        .create-room-panel input, .create-room-panel select { width: 100%; padding: 16px; margin: 8px 0; background: rgba(0,0,0,0.4); border: 1px solid #334455; border-radius: 16px; color: white; font-size: 16px; }
        .create-btn { width: 100%; padding: 18px; background: linear-gradient(145deg, #28c76f, #1f9f57); border: none; border-radius: 20px; color: white; font-weight: 700; font-size: 18px; margin-top: 15px; cursor: pointer; }
        
        .back-btn { background: transparent; border: 1px solid #556677; padding: 12px; border-radius: 40px; width: 100%; color: #aaccff; font-size: 16px; margin-top: 20px; cursor: pointer; }
        
        /* OYUN EKRANI (HUD) */
        #gameScreen { width: 100vw; height: 100vh; position: relative; background: #000; }
        #gameCanvas { width: 100%; height: 100%; display: block; }
        .hud { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .health-bar { position: absolute; top: 30px; left: 30px; width: 250px; height: 25px; background: #222; border-radius: 30px; border: 2px solid #fff; overflow: hidden; }
        .health-fill { height: 100%; width: 100%; background: linear-gradient(90deg, #ff4678, #ff8c5a); transition: width 0.2s; }
        .health-text { position: absolute; top: 30px; left: 300px; color: white; font-weight: 700; text-shadow: 2px 2px 0 black; }
        
        .team-hud { position: absolute; top: 80px; left: 30px; display: flex; gap: 30px; background: rgba(0,0,0,0.6); padding: 12px 25px; border-radius: 50px; backdrop-filter: blur(4px); border: 1px solid #445566; }
        .team-red { color: #ff6b6b; font-weight: 800; } .team-blue { color: #6ba6ff; font-weight: 800; }
        
        .kill-feed { position: absolute; top: 80px; right: 30px; width: 280px; display: flex; flex-direction: column; gap: 6px; }
        .kill-item { background: rgba(0,0,0,0.8); padding: 8px 15px; border-radius: 40px; border-left: 4px solid #ff4678; font-size: 14px; backdrop-filter: blur(2px); animation: slideIn 0.3s; }
        @keyframes slideIn { from { opacity: 0; transform: translateX(30px); } to { opacity: 1; transform: translateX(0); } }
        
        .joystick-left { position: absolute; bottom: 40px; left: 40px; width: 100px; height: 100px; background: rgba(255,255,255,0.15); border-radius: 50%; border: 2px solid rgba(255,255,255,0.3); backdrop-filter: blur(8px); pointer-events: auto; }
        .joystick-right { position: absolute; bottom: 40px; right: 120px; width: 100px; height: 100px; background: rgba(255,255,255,0.15); border-radius: 50%; border: 2px solid rgba(255,70,120,0.5); backdrop-filter: blur(8px); pointer-events: auto; }
        .fire-btn { position: absolute; bottom: 40px; right: 40px; width: 70px; height: 70px; background: #ff4678; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 32px; border: 3px solid white; pointer-events: auto; cursor: pointer; box-shadow: 0 0 20px #ff4678; }
        .jump-btn { position: absolute; bottom: 130px; right: 40px; width: 60px; height: 60px; background: rgba(0,0,0,0.6); border-radius: 50%; border: 2px solid white; display: flex; align-items: center; justify-content: center; font-size: 26px; pointer-events: auto; cursor: pointer; }
    </style>
</head>
<body>
    <!-- BEKLEME EKRANI -->
    <div id="loadingScreen">
        <div class="spinner"></div>
        <div class="loading-text">SA≈ûKƒ∞ OYUNU</div>
        <div class="loading-sub" id="loadingStatus">Sunucuya baƒülanƒ±yor...</div>
    </div>

    <!-- ANA MEN√ú (LOBƒ∞) -->
    <div id="mainMenu" style="display: none;">
        <div class="menu-header">
            <h1>üî´ SA≈ûKƒ∞</h1>
            <div class="user-badge" id="userBadge">
                <span id="menuUsername">Y√ºkleniyor...</span>
                <img id="userAvatar" src="" alt="Avatar">
            </div>
        </div>

        <div class="menu-buttons">
            <button class="menu-btn primary" onclick="quickPlay()"><span class="icon">‚ö°</span> HIZLI OYUN</button>
            <button class="menu-btn" onclick="showRooms()"><span class="icon">üìã</span> ODALAR</button>
            <button class="menu-btn" onclick="showCreateRoom()"><span class="icon">‚ûï</span> ODA OLU≈ûTUR</button>
        </div>

        <!-- Odalar Listesi (gizli) -->
        <div id="roomsPanel" style="display: none;">
            <div class="section-title"><span>üìã</span> AKTƒ∞F ODALAR</div>
            <div id="roomsContainer" class="rooms-grid"></div>
            <button class="back-btn" onclick="hideRooms()">‚Üê Geri</button>
        </div>

        <!-- Oda Olu≈üturma Paneli (gizli) -->
        <div id="createRoomPanel" style="display: none;">
            <div class="section-title"><span>‚öôÔ∏è</span> ODA OLU≈ûTUR</div>
            <div class="create-room-panel">
                <input type="text" id="roomNameInput" placeholder="Oda adƒ± (opsiyonel)">
                <select id="mapSelect">
                    <option value="backrooms">Backrooms (Labirent)</option>
                    <option value="warehouse">Depo Arenasƒ±</option>
                </select>
                <button class="create-btn" onclick="createRoom()">ODA OLU≈ûTUR</button>
            </div>
            <button class="back-btn" onclick="hideCreateRoom()">‚Üê Geri</button>
        </div>
    </div>

    <!-- OYUN EKRANI -->
    <div id="gameScreen" style="display: none;">
        <canvas id="gameCanvas"></canvas>
        <div class="hud">
            <div class="health-bar"><div class="health-fill" id="healthFill"></div></div>
            <div class="health-text" id="healthText">100</div>
            
            <div class="team-hud">
                <span class="team-red">üî¥ <span id="redCount">0</span></span>
                <span class="team-blue">üîµ <span id="blueCount">0</span></span>
            </div>
            
            <div class="kill-feed" id="killFeed"></div>
            
            <!-- Mobil kontroller -->
            <div class="joystick-left" id="moveJoystick"></div>
            <div class="joystick-right" id="lookJoystick"></div>
            <div class="fire-btn" id="fireBtn" ontouchstart="isFiring=true" ontouchend="isFiring=false">üî´</div>
            <div class="jump-btn" id="jumpBtn" onclick="if(game) game.jump()">ü¶ò</div>
        </div>
    </div>

    <script>
        // --------------------------------------------------------------
        // ANA DEƒûƒ∞≈ûKENLER
        // --------------------------------------------------------------
        const tg = Telegram.WebApp;
        tg.expand();
        
        let socket = null;
        let game = null;
        let userData = null;
        let currentRoomId = null;
        let players = {};
        let myPlayer = null;
        let isFiring = false;

        // --------------------------------------------------------------
        // TELEGRAM KULLANICI Bƒ∞LGƒ∞LERƒ∞
        // --------------------------------------------------------------
        if (tg.initDataUnsafe.user) {
            userData = tg.initDataUnsafe.user;
            document.getElementById('menuUsername').innerText = userData.username || userData.first_name;
            if (userData.photo_url) {
                document.getElementById('userAvatar').src = userData.photo_url;
            }
        }

        // --------------------------------------------------------------
        // SUNUCUYA BAƒûLANMA
        // --------------------------------------------------------------
        function connectServer() {
            document.getElementById('loadingStatus').innerText = 'Sunucuya baƒülanƒ±yor...';
            
            socket = io('https://saskioyunu-1-2d6i.onrender.com', {
                reconnection: true,
                reconnectionAttempts: Infinity,
                reconnectionDelay: 1000,
                timeout: 10000
            });

            socket.on('connect', () => {
                console.log('‚úÖ Sunucuya baƒülandƒ±, ID:', socket.id);
                document.getElementById('loadingScreen').style.opacity = '0';
                setTimeout(() => {
                    document.getElementById('loadingScreen').style.display = 'none';
                    document.getElementById('mainMenu').style.display = 'flex';
                }, 500);
            });

            socket.on('connect_error', (err) => {
                document.getElementById('loadingStatus').innerHTML = '‚ö†Ô∏è Sunucuya baƒülanƒ±lamadƒ±, yeniden deneniyor...<br><small>' + err.message + '</small>';
                console.log('Baƒülantƒ± hatasƒ±:', err);
            });

            socket.on('disconnect', () => {
                document.getElementById('loadingScreen').style.display = 'flex';
                document.getElementById('loadingScreen').style.opacity = '1';
                document.getElementById('loadingStatus').innerText = 'Baƒülantƒ± koptu, yeniden baƒülanƒ±yor...';
            });

            // Oyun i√ßi socket olaylarƒ± a≈üaƒüƒ±da tanƒ±mlanacak (game.js i√ßinde)
        }

        // --------------------------------------------------------------
        // MEN√ú FONKSƒ∞YONLARI
        // --------------------------------------------------------------
        window.quickPlay = function() {
            joinRoom(null); // rastgele oda
        };

        window.showRooms = function() {
            document.getElementById('roomsPanel').style.display = 'block';
            document.getElementById('createRoomPanel').style.display = 'none';
            fetchRooms();
        };

        window.hideRooms = function() {
            document.getElementById('roomsPanel').style.display = 'none';
        };

        window.showCreateRoom = function() {
            document.getElementById('createRoomPanel').style.display = 'block';
            document.getElementById('roomsPanel').style.display = 'none';
        };

        window.hideCreateRoom = function() {
            document.getElementById('createRoomPanel').style.display = 'none';
        };

        async function fetchRooms() {
            try {
                const res = await fetch('https://saskioyunu-1-2d6i.onrender.com/api/rooms');
                const rooms = await res.json();
                const container = document.getElementById('roomsContainer');
                if (rooms.length === 0) {
                    container.innerHTML = '<div style="text-align:center;padding:30px;background:#1a2635;border-radius:30px;">Hen√ºz oda yok, bir tane olu≈üturun!</div>';
                    return;
                }
                container.innerHTML = rooms.map(r => `
                    <div class="room-card">
                        <div class="room-name">${r.name}</div>
                        <div class="room-players">
                            <span class="team-badge red">üî¥ ${r.redCount}</span>
                            <span class="team-badge blue">üîµ ${r.blueCount}</span>
                        </div>
                        <button class="join-btn" onclick="joinRoom('${r.id}')">KATIL</button>
                    </div>
                `).join('');
            } catch (e) {
                alert('Odalar alƒ±namadƒ±: ' + e.message);
            }
        }

        window.createRoom = function() {
            const name = document.getElementById('roomNameInput').value;
            const map = document.getElementById('mapSelect').value;
            fetch('https://saskioyunu-1-2d6i.onrender.com/api/rooms/create', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ name, map })
            })
            .then(res => res.json())
            .then(data => {
                joinRoom(data.id);
            });
        };

        window.joinRoom = function(roomId) {
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            currentRoomId = roomId;

            // Oyun motorunu ba≈ülat (eƒüer yoksa)
            if (!game) {
                initGame();
            }

            // Sunucuya katƒ±lma isteƒüi g√∂nder
            socket.emit('joinRoom', {
                username: userData?.username || 'Oyuncu',
                telegramId: userData?.id || 'guest_' + Math.random(),
                roomId: roomId
            });
        };

        // --------------------------------------------------------------
        // OYUN MOTORU (Three.js)
        // --------------------------------------------------------------
        function initGame() {
            game = new GameEngine();
        }

        class GameEngine {
            constructor() {
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0x11151f);
                
                this.camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                this.renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('gameCanvas'), antialias: true });
                this.renderer.setSize(window.innerWidth, window.innerHeight);
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                
                // I≈üƒ±klar
                const ambient = new THREE.AmbientLight(0x404060);
                this.scene.add(ambient);
                
                const dirLight = new THREE.DirectionalLight(0xffeedd, 1.2);
                dirLight.position.set(5, 20, 10);
                dirLight.castShadow = true;
                dirLight.shadow.mapSize.width = 1024;
                dirLight.shadow.mapSize.height = 1024;
                this.scene.add(dirLight);
                
                // HARƒ∞TA (Backrooms)
                this.createMap();
                
                // Diƒüer oyuncularƒ± tutacak map
                this.playerMeshes = new Map(); // id -> mesh
                
                // Animasyon d√∂ng√ºs√º
                this.animate();
                
                // Socket olaylarƒ±nƒ± dinle
                this.setupSocketEvents();
            }

            createMap() {
                // Zemin (gri beton)
                const floorGeo = new THREE.PlaneGeometry(60, 60);
                const floorMat = new THREE.MeshStandardMaterial({ color: 0xaaaaaa, roughness: 0.7, metalness: 0.1 });
                const floor = new THREE.Mesh(floorGeo, floorMat);
                floor.rotation.x = -Math.PI / 2;
                floor.position.y = 0;
                floor.receiveShadow = true;
                this.scene.add(floor);

                // Grid deseni (isteƒüe baƒülƒ±)
                const grid = new THREE.GridHelper(60, 30, 0xffaa88, 0x445566);
                grid.position.y = 0.01;
                this.scene.add(grid);

                // Duvarlar (sarƒ± backrooms tarzƒ±)
                const wallMat = new THREE.MeshStandardMaterial({ color: 0xeedd99, emissive: 0x221100 });
                
                // Dƒ±≈ü duvarlar
                const wallHeight = 5;
                const wallThick = 1;
                const size = 28;
                
                const walls = [
                    { pos: [0, wallHeight/2, -size], scale: [size*2, wallHeight, wallThick] },
                    { pos: [0, wallHeight/2, size], scale: [size*2, wallHeight, wallThick] },
                    { pos: [-size, wallHeight/2, 0], scale: [wallThick, wallHeight, size*2] },
                    { pos: [size, wallHeight/2, 0], scale: [wallThick, wallHeight, size*2] }
                ];
                walls.forEach(w => {
                    const wall = new THREE.Mesh(new THREE.BoxGeometry(...w.scale), wallMat);
                    wall.position.set(...w.pos);
                    wall.castShadow = true;
                    wall.receiveShadow = true;
                    this.scene.add(wall);
                });

                // ƒ∞√ß koridor duvarlarƒ± (labirent)
                for (let i = -20; i <= 20; i+= 8) {
                    for (let j = -20; j <= 20; j+= 8) {
                        if (Math.random() > 0.6) {
                            const pillar = new THREE.Mesh(new THREE.BoxGeometry(1.5, 4, 1.5), new THREE.MeshStandardMaterial({ color: 0xbb9966 }));
                            pillar.position.set(i, 2, j);
                            pillar.castShadow = true;
                            pillar.receiveShadow = true;
                            this.scene.add(pillar);
                        }
                    }
                }
            }

            // Karakter olu≈üturma (Minecraft tarzƒ± blok karakter)
            createPlayerMesh(team = 'red') {
                const group = new THREE.Group();
                
                // Renkler
                const shirtColor = team === 'red' ? 0xff5555 : 0x5555ff;
                const pantColor = 0x2a4a6a;
                const skinColor = 0xefcbaa;
                
                // G√∂vde (blok)
                const bodyGeo = new THREE.BoxGeometry(0.8, 1.2, 0.4);
                const bodyMat = new THREE.MeshStandardMaterial({ color: shirtColor });
                const body = new THREE.Mesh(bodyGeo, bodyMat);
                body.position.y = 0.6;
                body.castShadow = true;
                body.receiveShadow = true;
                group.add(body);
                
                // Ba≈ü (k√ºp)
                const headGeo = new THREE.BoxGeometry(0.7, 0.7, 0.7);
                const headMat = new THREE.MeshStandardMaterial({ color: skinColor });
                const head = new THREE.Mesh(headGeo, headMat);
                head.position.y = 1.3;
                head.castShadow = true;
                head.receiveShadow = true;
                group.add(head);
                
                // Kollar
                const armGeo = new THREE.BoxGeometry(0.3, 0.9, 0.3);
                const armMat = new THREE.MeshStandardMaterial({ color: shirtColor });
                
                const leftArm = new THREE.Mesh(armGeo, armMat);
                leftArm.position.set(-0.6, 0.8, 0);
                leftArm.castShadow = true;
                group.add(leftArm);
                
                const rightArm = new THREE.Mesh(armGeo, armMat);
                rightArm.position.set(0.6, 0.8, 0);
                rightArm.castShadow = true;
                group.add(rightArm);
                
                // Bacaklar
                const legGeo = new THREE.BoxGeometry(0.35, 0.8, 0.35);
                const legMat = new THREE.MeshStandardMaterial({ color: pantColor });
                
                const leftLeg = new THREE.Mesh(legGeo, legMat);
                leftLeg.position.set(-0.25, 0, 0);
                leftLeg.castShadow = true;
                group.add(leftLeg);
                
                const rightLeg = new THREE.Mesh(legGeo, legMat);
                rightLeg.position.set(0.25, 0, 0);
                rightLeg.castShadow = true;
                group.add(rightLeg);
                
                return group;
            }

            setupSocketEvents() {
                socket.on('roomJoined', (data) => {
                    console.log('Odaya katƒ±ldƒ±:', data);
                    document.getElementById('redCount').innerText = data.redCount;
                    document.getElementById('blueCount').innerText = data.blueCount;
                    
                    // Mevcut t√ºm oyuncularƒ± ekle
                    for (let id in data.players) {
                        if (id !== socket.id) {
                            this.addOtherPlayer(data.players[id]);
                        } else {
                            // Kendi oyuncum
                            myPlayer = data.players[id];
                            this.camera.position.set(myPlayer.position.x, myPlayer.position.y+1.2, myPlayer.position.z);
                        }
                    }
                });

                socket.on('newPlayer', (player) => {
                    this.addOtherPlayer(player);
                });

                socket.on('playerMoved', (data) => {
                    const mesh = this.playerMeshes.get(data.id);
                    if (mesh) {
                        mesh.position.set(data.position.x, data.position.y, data.position.z);
                    }
                });

                socket.on('playerHit', (data) => {
                    if (data.targetId === socket.id) {
                        // Bana vurdular
                        document.getElementById('healthFill').style.width = data.health + '%';
                        document.getElementById('healthText').innerText = data.health;
                    }
                    this.addKillFeed(`üéØ ${data.hitZone} vuru≈üu!`);
                });

                socket.on('playerDied', (data) => {
                    this.addKillFeed(`üíÄ ${data.killerName} √∂ld√ºrd√º ${data.victimName}`);
                    const mesh = this.playerMeshes.get(data.victimId);
                    if (mesh) mesh.visible = false;
                });

                socket.on('playerRespawn', (player) => {
                    if (player.id === socket.id) {
                        document.getElementById('healthFill').style.width = '100%';
                        document.getElementById('healthText').innerText = '100';
                    }
                    const mesh = this.playerMeshes.get(player.id);
                    if (mesh) {
                        mesh.visible = true;
                        mesh.position.set(player.position.x, player.position.y, player.position.z);
                    }
                });

                socket.on('playerLeft', (id) => {
                    const mesh = this.playerMeshes.get(id);
                    if (mesh) {
                        this.scene.remove(mesh);
                        this.playerMeshes.delete(id);
                    }
                });
            }

            addOtherPlayer(player) {
                const mesh = this.createPlayerMesh(player.team);
                mesh.position.set(player.position.x, player.position.y, player.position.z);
                this.scene.add(mesh);
                this.playerMeshes.set(player.id, mesh);
            }

            addKillFeed(text) {
                const feed = document.getElementById('killFeed');
                const item = document.createElement('div');
                item.className = 'kill-item';
                item.innerText = text;
                feed.appendChild(item);
                setTimeout(() => item.remove(), 3000);
            }

            jump() {
                // Zƒ±plama animasyonu (basit)
                if (myPlayer) {
                    // Sunucuya g√∂nderebiliriz, ama ≈üimdilik local
                }
            }

            animate() {
                requestAnimationFrame(() => this.animate());

                // Ate≈ü etme kontrol√º
                if (isFiring && myPlayer) {
                    // Raycast atƒ±≈ü burada yapƒ±labilir, ama kƒ±sa kalsƒ±n
                }

                // Kamera takibi (kendi oyuncumuzu merkeze al)
                if (myPlayer) {
                    // Kamera biraz arkadan ve yukarƒ±dan baksƒ±n
                    this.camera.position.x = myPlayer.position.x;
                    this.camera.position.z = myPlayer.position.z + 5;
                    this.camera.position.y = myPlayer.position.y + 3;
                    this.camera.lookAt(myPlayer.position.x, myPlayer.position.y+1, myPlayer.position.z);
                }

                this.renderer.render(this.scene, this.camera);
            }
        }

        // Baƒülantƒ±yƒ± ba≈ülat
        connectServer();
    </script>
</body>
</html>
